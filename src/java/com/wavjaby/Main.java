package com.wavjaby;

import com.wavjaby.github.Api;
import com.wavjaby.json.JsonObject;
import sun.net.www.protocol.https.HttpsURLConnectionImpl;

import java.io.*;
import java.net.URL;
import java.nio.charset.Charset;
import java.nio.charset.StandardCharsets;

public class Main {
    Main() {
        long startTime = System.currentTimeMillis();
        Api api = new Api("e2e712936ef93498a6d4", "c375e65785c3dcfd7f533640a3dd7a491739083d");


//        try {
//            // https://github.com/login/oauth/authorize?client_id=e2e712936ef93498a6d4
//            String code = "9468ca5a072b207c8717";
//            String client_id = "e2e712936ef93498a6d4";
//            String client_secret = "c375e65785c3dcfd7f533640a3dd7a491739083d";
//            HttpsURLConnectionImpl conn = (HttpsURLConnectionImpl) new URL("https://github.com/login/oauth/access_token").openConnection();
//            conn.setRequestProperty("Accept", "application/json");
//            conn.setRequestMethod("POST");
//            conn.setDoOutput(true);
//
//            conn.getOutputStream().write(("client_id=" + client_id + "&client_secret=" + client_secret + "&code=" + code).getBytes());
//            System.out.println(new JsonObject(conn.getInputStream()).getString("access_token"));
//        } catch (IOException e) {
//            throw new RuntimeException(e);
//        }

        try {
            HttpsURLConnectionImpl conn = (HttpsURLConnectionImpl) new URL("https://api.github.com/graphql").openConnection();
            conn.setRequestProperty("X-GitHub-Api-Version", "2022-11-28");
            conn.setRequestProperty("Accept", "application/vnd.github+json");
            conn.setRequestProperty("Authorization", "Bearer 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");
            conn.setRequestMethod("POST");
            conn.setDoOutput(true);

            conn.getOutputStream().write(new JsonObject().put("query", "" +
                            "query ($userName: String!) {\n" +
                            "  user(login: $userName) {\n" +
                            "    login\n" +
                            "    contributionsCollection {\n" +
                            "      contributionCalendar {\n" +
                            "        colors\n" +
                            "        totalContributions\n" +
                            "        weeks {\n" +
                            "          firstDay\n" +
                            "          contributionDays {\n" +
                            "            color\n" +
                            "            contributionCount\n" +
                            "            date\n" +
                            "          }\n" +
                            "        }\n" +
                            "      }\n" +
                            "    }\n" +
                            "  }\n" +
                            "}")
                    .put("variables", new JsonObject()
                            .put("userName", "scoobytux")
                    )
                    .toString().getBytes());
            if (conn.getResponseCode() > 399) {
                System.out.println(new JsonObject(conn.getErrorStream()).toStringBeauty());
                return;
            }

//            JsonObject json = new JsonObject(conn.getInputStream());
            JsonObject json = new JsonObject("{\"data\":{\"user\":{\"login\":\"scoobytux\",\"contributionsCollection\":{\"contributionCalendar\":{\"totalContributions\":949,\"weeks\":[{\"firstDay\":\"2022-05-29\",\"contributionDays\":[{\"date\":\"2022-05-29\",\"color\":\"#40c463\",\"contributionCount\":7},{\"date\":\"2022-05-30\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-05-31\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-01\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-02\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-03\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-04\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-06-05\",\"contributionDays\":[{\"date\":\"2022-06-05\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-06\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-06-07\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-06-08\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-09\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-06-10\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-06-11\",\"color\":\"#9be9a8\",\"contributionCount\":5}]},{\"firstDay\":\"2022-06-12\",\"contributionDays\":[{\"date\":\"2022-06-12\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-17\",\"color\":\"#30a14e\",\"contributionCount\":11},{\"date\":\"2022-06-18\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-06-19\",\"contributionDays\":[{\"date\":\"2022-06-19\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-06-20\",\"color\":\"#40c463\",\"contributionCount\":9},{\"date\":\"2022-06-21\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-06-22\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-06-23\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-06-24\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-06-25\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-06-26\",\"contributionDays\":[{\"date\":\"2022-06-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-27\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-28\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-29\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-06-30\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-07-01\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-07-02\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-07-03\",\"contributionDays\":[{\"date\":\"2022-07-03\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-07-04\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-07-05\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-07-06\",\"color\":\"#40c463\",\"contributionCount\":9},{\"date\":\"2022-07-07\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-07-08\",\"color\":\"#216e39\",\"contributionCount\":20},{\"date\":\"2022-07-09\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-07-10\",\"contributionDays\":[{\"date\":\"2022-07-10\",\"color\":\"#30a14e\",\"contributionCount\":11},{\"date\":\"2022-07-11\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-07-12\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-07-13\",\"color\":\"#216e39\",\"contributionCount\":27},{\"date\":\"2022-07-14\",\"color\":\"#40c463\",\"contributionCount\":8},{\"date\":\"2022-07-15\",\"color\":\"#30a14e\",\"contributionCount\":12},{\"date\":\"2022-07-16\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2022-07-17\",\"contributionDays\":[{\"date\":\"2022-07-17\",\"color\":\"#30a14e\",\"contributionCount\":12},{\"date\":\"2022-07-18\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-07-19\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-07-20\",\"color\":\"#30a14e\",\"contributionCount\":14},{\"date\":\"2022-07-21\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-07-22\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-07-23\",\"color\":\"#216e39\",\"contributionCount\":16}]},{\"firstDay\":\"2022-07-24\",\"contributionDays\":[{\"date\":\"2022-07-24\",\"color\":\"#216e39\",\"contributionCount\":19},{\"date\":\"2022-07-25\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-07-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-07-27\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-07-28\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-07-29\",\"color\":\"#40c463\",\"contributionCount\":9},{\"date\":\"2022-07-30\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-07-31\",\"contributionDays\":[{\"date\":\"2022-07-31\",\"color\":\"#30a14e\",\"contributionCount\":15},{\"date\":\"2022-08-01\",\"color\":\"#30a14e\",\"contributionCount\":11},{\"date\":\"2022-08-02\",\"color\":\"#30a14e\",\"contributionCount\":15},{\"date\":\"2022-08-03\",\"color\":\"#30a14e\",\"contributionCount\":13},{\"date\":\"2022-08-04\",\"color\":\"#30a14e\",\"contributionCount\":15},{\"date\":\"2022-08-05\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-08-06\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-08-07\",\"contributionDays\":[{\"date\":\"2022-08-07\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-08\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-09\",\"color\":\"#30a14e\",\"contributionCount\":13},{\"date\":\"2022-08-10\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-11\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-12\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-13\",\"color\":\"#40c463\",\"contributionCount\":10}]},{\"firstDay\":\"2022-08-14\",\"contributionDays\":[{\"date\":\"2022-08-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-08-17\",\"color\":\"#40c463\",\"contributionCount\":10},{\"date\":\"2022-08-18\",\"color\":\"#30a14e\",\"contributionCount\":13},{\"date\":\"2022-08-19\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-08-20\",\"color\":\"#9be9a8\",\"contributionCount\":2}]},{\"firstDay\":\"2022-08-21\",\"contributionDays\":[{\"date\":\"2022-08-21\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-08-22\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-08-23\",\"color\":\"#40c463\",\"contributionCount\":10},{\"date\":\"2022-08-24\",\"color\":\"#40c463\",\"contributionCount\":9},{\"date\":\"2022-08-25\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-08-26\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-08-27\",\"color\":\"#9be9a8\",\"contributionCount\":5}]},{\"firstDay\":\"2022-08-28\",\"contributionDays\":[{\"date\":\"2022-08-28\",\"color\":\"#216e39\",\"contributionCount\":20},{\"date\":\"2022-08-29\",\"color\":\"#216e39\",\"contributionCount\":17},{\"date\":\"2022-08-30\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-08-31\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-09-01\",\"color\":\"#216e39\",\"contributionCount\":16},{\"date\":\"2022-09-02\",\"color\":\"#30a14e\",\"contributionCount\":12},{\"date\":\"2022-09-03\",\"color\":\"#40c463\",\"contributionCount\":7}]},{\"firstDay\":\"2022-09-04\",\"contributionDays\":[{\"date\":\"2022-09-04\",\"color\":\"#40c463\",\"contributionCount\":8},{\"date\":\"2022-09-05\",\"color\":\"#216e39\",\"contributionCount\":17},{\"date\":\"2022-09-06\",\"color\":\"#216e39\",\"contributionCount\":27},{\"date\":\"2022-09-07\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-09-08\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-09-09\",\"color\":\"#40c463\",\"contributionCount\":8},{\"date\":\"2022-09-10\",\"color\":\"#9be9a8\",\"contributionCount\":3}]},{\"firstDay\":\"2022-09-11\",\"contributionDays\":[{\"date\":\"2022-09-11\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-09-12\",\"color\":\"#216e39\",\"contributionCount\":25},{\"date\":\"2022-09-13\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-09-14\",\"color\":\"#216e39\",\"contributionCount\":29},{\"date\":\"2022-09-15\",\"color\":\"#40c463\",\"contributionCount\":9},{\"date\":\"2022-09-16\",\"color\":\"#40c463\",\"contributionCount\":7},{\"date\":\"2022-09-17\",\"color\":\"#30a14e\",\"contributionCount\":12}]},{\"firstDay\":\"2022-09-18\",\"contributionDays\":[{\"date\":\"2022-09-18\",\"color\":\"#40c463\",\"contributionCount\":9},{\"date\":\"2022-09-19\",\"color\":\"#40c463\",\"contributionCount\":7},{\"date\":\"2022-09-20\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-09-21\",\"color\":\"#40c463\",\"contributionCount\":10},{\"date\":\"2022-09-22\",\"color\":\"#30a14e\",\"contributionCount\":14},{\"date\":\"2022-09-23\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-09-24\",\"color\":\"#9be9a8\",\"contributionCount\":3}]},{\"firstDay\":\"2022-09-25\",\"contributionDays\":[{\"date\":\"2022-09-25\",\"color\":\"#40c463\",\"contributionCount\":7},{\"date\":\"2022-09-26\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-09-27\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-09-28\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-09-29\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-09-30\",\"color\":\"#40c463\",\"contributionCount\":7},{\"date\":\"2022-10-01\",\"color\":\"#9be9a8\",\"contributionCount\":2}]},{\"firstDay\":\"2022-10-02\",\"contributionDays\":[{\"date\":\"2022-10-02\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-03\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-04\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2022-10-05\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-06\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-07\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-08\",\"color\":\"#9be9a8\",\"contributionCount\":2}]},{\"firstDay\":\"2022-10-09\",\"contributionDays\":[{\"date\":\"2022-10-09\",\"color\":\"#40c463\",\"contributionCount\":8},{\"date\":\"2022-10-10\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-11\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-12\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-10-14\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2022-10-15\",\"color\":\"#9be9a8\",\"contributionCount\":2}]},{\"firstDay\":\"2022-10-16\",\"contributionDays\":[{\"date\":\"2022-10-16\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-17\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-18\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-19\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-20\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-21\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-22\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2022-10-23\",\"contributionDays\":[{\"date\":\"2022-10-23\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-10-24\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2022-10-25\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-26\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2022-10-27\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-10-28\",\"color\":\"#40c463\",\"contributionCount\":6},{\"date\":\"2022-10-29\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2022-10-30\",\"contributionDays\":[{\"date\":\"2022-10-30\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-10-31\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-01\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-02\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-03\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-04\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-05\",\"color\":\"#9be9a8\",\"contributionCount\":4}]},{\"firstDay\":\"2022-11-06\",\"contributionDays\":[{\"date\":\"2022-11-06\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-07\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-08\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-09\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-10\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-11\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-12\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2022-11-13\",\"contributionDays\":[{\"date\":\"2022-11-13\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-14\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-15\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-11-16\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-17\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-18\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-19\",\"color\":\"#40c463\",\"contributionCount\":6}]},{\"firstDay\":\"2022-11-20\",\"contributionDays\":[{\"date\":\"2022-11-20\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-21\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-22\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-23\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-24\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-25\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-26\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2022-11-27\",\"contributionDays\":[{\"date\":\"2022-11-27\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-28\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-29\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-11-30\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-12-01\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-02\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-03\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2022-12-04\",\"contributionDays\":[{\"date\":\"2022-12-04\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-05\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-06\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-07\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-08\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-09\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-10\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-12-11\",\"contributionDays\":[{\"date\":\"2022-12-11\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-12\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-17\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2022-12-18\",\"contributionDays\":[{\"date\":\"2022-12-18\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-19\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-20\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2022-12-21\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-22\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2022-12-23\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2022-12-24\",\"color\":\"#40c463\",\"contributionCount\":7}]},{\"firstDay\":\"2022-12-25\",\"contributionDays\":[{\"date\":\"2022-12-25\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2022-12-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-27\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-28\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2022-12-29\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-30\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2022-12-31\",\"color\":\"#9be9a8\",\"contributionCount\":2}]},{\"firstDay\":\"2023-01-01\",\"contributionDays\":[{\"date\":\"2023-01-01\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-02\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-03\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-01-04\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-05\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-01-06\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-01-07\",\"color\":\"#9be9a8\",\"contributionCount\":4}]},{\"firstDay\":\"2023-01-08\",\"contributionDays\":[{\"date\":\"2023-01-08\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-09\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-10\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-11\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2023-01-12\",\"color\":\"#40c463\",\"contributionCount\":7},{\"date\":\"2023-01-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-14\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-01-15\",\"contributionDays\":[{\"date\":\"2023-01-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-17\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-18\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-19\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-20\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-21\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2023-01-22\",\"contributionDays\":[{\"date\":\"2023-01-22\",\"color\":\"#9be9a8\",\"contributionCount\":4},{\"date\":\"2023-01-23\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-24\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-01-25\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-01-26\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-01-27\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-28\",\"color\":\"#9be9a8\",\"contributionCount\":1}]},{\"firstDay\":\"2023-01-29\",\"contributionDays\":[{\"date\":\"2023-01-29\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-30\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-01-31\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-01\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-02\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-03\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-04\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-02-05\",\"contributionDays\":[{\"date\":\"2023-02-05\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-06\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-07\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-08\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-09\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-10\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-11\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-02-12\",\"contributionDays\":[{\"date\":\"2023-02-12\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-17\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-18\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-02-19\",\"contributionDays\":[{\"date\":\"2023-02-19\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-20\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-21\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-22\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-23\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-24\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-25\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-02-26\",\"contributionDays\":[{\"date\":\"2023-02-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-02-27\",\"color\":\"#9be9a8\",\"contributionCount\":2},{\"date\":\"2023-02-28\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-01\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-02\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-03\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-04\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-03-05\",\"contributionDays\":[{\"date\":\"2023-03-05\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-06\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-07\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-08\",\"color\":\"#9be9a8\",\"contributionCount\":3},{\"date\":\"2023-03-09\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-03-10\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-03-11\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-03-12\",\"contributionDays\":[{\"date\":\"2023-03-12\",\"color\":\"#9be9a8\",\"contributionCount\":5},{\"date\":\"2023-03-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-17\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-18\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-03-19\",\"contributionDays\":[{\"date\":\"2023-03-19\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-20\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-21\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-22\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-23\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-24\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-25\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-03-26\",\"contributionDays\":[{\"date\":\"2023-03-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-27\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-28\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-29\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-30\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-03-31\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-01\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-04-02\",\"contributionDays\":[{\"date\":\"2023-04-02\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-03\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-04\",\"color\":\"#9be9a8\",\"contributionCount\":1},{\"date\":\"2023-04-05\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-06\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-07\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-08\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-04-09\",\"contributionDays\":[{\"date\":\"2023-04-09\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-10\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-11\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-12\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-13\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-15\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-04-16\",\"contributionDays\":[{\"date\":\"2023-04-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-17\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-18\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-19\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-20\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-21\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-22\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-04-23\",\"contributionDays\":[{\"date\":\"2023-04-23\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-24\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-25\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-27\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-28\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-04-29\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-04-30\",\"contributionDays\":[{\"date\":\"2023-04-30\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-01\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-02\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-03\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-04\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-05\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-06\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-05-07\",\"contributionDays\":[{\"date\":\"2023-05-07\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-08\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-09\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-10\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-11\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-12\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-13\",\"color\":\"#40c463\",\"contributionCount\":6}]},{\"firstDay\":\"2023-05-14\",\"contributionDays\":[{\"date\":\"2023-05-14\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-15\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-16\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-17\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-18\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-19\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-20\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-05-21\",\"contributionDays\":[{\"date\":\"2023-05-21\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-22\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-23\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-24\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-25\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-26\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-27\",\"color\":\"#ebedf0\",\"contributionCount\":0}]},{\"firstDay\":\"2023-05-28\",\"contributionDays\":[{\"date\":\"2023-05-28\",\"color\":\"#ebedf0\",\"contributionCount\":0},{\"date\":\"2023-05-29\",\"color\":\"#ebedf0\",\"contributionCount\":0}]}],\"colors\":[\"#9be9a8\",\"#40c463\",\"#30a14e\",\"#216e39\"]}}}}}");
//            System.out.println(json);
//            System.out.println(json.get("data").get("user").toStringBeauty());
            JsonObject contributions = json.get("data").get("user").get("contributionsCollection");
            String svg = SvgBuilder.contributionCalendarToSnakeSvg(contributions.get("contributionCalendar"));
            try {
                FileWriter fileWriter = new FileWriter("out3.svg");
                fileWriter.write(svg);
                fileWriter.close();
            } catch (IOException e) {
                throw new RuntimeException(e);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

//        api.getUserRepos("WavJaby").queue(repos -> {
//            Map<String, Long> totalLanguage = new HashMap<>();
//            CountDownLatch count = new CountDownLatch(repos.getSize());
//            for (Repo repo : repos) {
//                if (repo.isFork()) {
//                    count.countDown();
//                    continue;
//                }
//                repo.getUsedLanguages().queue(languages -> {
//                    for (Map.Entry<String, Long> lang : languages.getLanguages().entrySet()) {
//                        Long langLen = totalLanguage.getOrDefault(lang.getKey(), 0L);
//                        langLen += lang.getValue();
//                        totalLanguage.put(lang.getKey(), langLen);
//                    }
//                    count.countDown();
//                }, e -> count.countDown());
//            }
//            try {
//                count.await();
//            } catch (InterruptedException e) {
//                e.printStackTrace();
//                return;
//            }
//
//            List<Map.Entry<String, Long>> languages = totalLanguage.entrySet().stream()
//                    .sorted((a, b) -> (int) (b.getValue() - a.getValue()))
//                    .collect(Collectors.toList());
//
//            System.out.println(languages.size());
//            String result = SvgBuilder.languagesToPieChartSvg(languages, 10);
//            try {
//                FileWriter fileWriter = new FileWriter("out2.svg");
//                fileWriter.write(result);
//                fileWriter.close();
//            } catch (IOException e) {
//                throw new RuntimeException(e);
//            }
//            System.out.println("Done");
//        });


        System.out.println((System.currentTimeMillis() - startTime) + "ms");
        api.close();
    }

    public String readToString(InputStream input, Charset charset) {
        char[] chars = new char[0];

        try {
            InputStreamReader inputReader = new InputStreamReader(input, charset);
            CharArrayWriter out = new CharArrayWriter();
            char[] buff = new char[1024];

            int len;
            while ((len = inputReader.read(buff, 0, buff.length)) > 0) {
                out.write(buff, 0, len);
            }

            chars = out.toCharArray();
            input.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return new String(chars, 0, chars.length);
    }

    public static void main(String[] args) {
        new Main();
    }
}
